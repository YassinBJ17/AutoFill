                               File: ELBCBOOT_C Errors    0
  Location Pl  Code            Line 	Source Statement
  00000000 00                     1 		.file "ELBCBOOT_CBHW_ConfigureBasicHW.s"
  00000000 00                     2 		.include "ELBCBOOT_Registers.inc"
  00000000 00                     1I	; HID0 init value, enable timer base
  00000000 00                     2I	.set     C_HID0_INIT_VALUE     ,0x00004000
  00000000 00                     3I	
  00000000 00                     4I	; Hardware Implementation Dependent registers
  00000000 00                     5I	.set    REG_HID0    ,1008
  00000000 00                     6I	.set    REG_HID1    ,1009
  00000000 00                     7I	
  00000000 00                     8I	; Branch Unit Control and Status Register
  00000000 00                     9I	.set    REG_BUCSR   ,1013
  00000000 00                    10I	
  00000000 00                    11I	; MMU Assist registers
  00000000 00                    12I	.set    REG_MAS0        ,624
  00000000 00                    13I	.set    REG_MAS1        ,625
  00000000 00                    14I	.set    REG_MAS2        ,626
  00000000 00                    15I	.set    REG_MAS3        ,627
  00000000 00                    16I	.set    REG_MAS4        ,628
  00000000 00                    17I	.set    REG_MAS6        ,630
  00000000 00                    18I	.set    REG_MAS7        ,944
  00000000 00                    19I	
  00000000 00                    20I	#/* _END_CONSTANT ==========================================================================
  00000000 00                       	========================== */
  00000000 00                    21I	
  00000000 00                    22I	#/* _BEGIN_MACRO ================================================ MACROS ===================
  00000000 00                       	========================== */
  00000000 00                    23I	
  00000000 00                    24I	#/*=========================================================================================
  00000000 00                       	========================== */
  00000000 00                    25I	#/*                                                        MSR                              
  00000000 00                       	                           */
  00000000 00                    26I	#/*=========================================================================================
  00000000 00                       	========================== */
  00000000 00                    27I	
  00000000 00                    28I	#/* BEGIN FUNCTION HEADER-------------------------------------------------------------------
  00000000 00                       	-------------------------- */
  00000000 00                    29I	#/* <<LLR:  >>  SDD_DMS_LLR_REQ_0000022                                                     
  00000000 00                       	                           */
  00000000 00                    30I	#/*                                                                                         
  00000000 00                       	                           */
  00000000 00                    31I	#/* <<FUNCTION:  >>  REG_MSR_WRITE                                                          
  00000000 00                       	                           */
  00000000 00                    32I	#/*                                                                                         
  00000000 00                       	                           */
  00000000 00                    33I	#/* <<DESCRIPTION:  >>  This function writes a new MSR value. The MSR register is writeable 
  00000000 00                       	only in supervisor mode. I */
  00000000 00                    34I	#/* t is a macro function in assembly language.                                             
  00000000 00                       	                           */
  00000000 00                    35I	#/*                                                                                         
  00000000 00                       	                           */
  00000000 00                    36I	#/* END FUNCTION HEADER---------------------------------------------------------------------
  00000000 00                       	-------------------------- */
  00000000 00                    37I	REG_MSR_WRITE: .macro v_reg1
                                 38I		sync
                                 39I		mtmsr    v_reg1
                                 40I		sync
                                 41I		isync
                               File: ELBCBOOT_C Errors    0
  Location Pl  Code            Line 	Source Statement
                                 42I		.endm
  00000000 00                    43I	
  00000000 00                    44I	#/*End of REG_MSR_WRITE*/
  00000000 00                    45I	
  00000000 00                    46I	#/* BEGIN FUNCTION HEADER-------------------------------------------------------------------
  00000000 00                       	-------------------------- */
  00000000 00                    47I	#/* <<LLR:  >>  SDD_DMS_LLR_REQ_0000021                                                     
  00000000 00                       	                           */
  00000000 00                    48I	#/*                                                                                         
  00000000 00                       	                           */
  00000000 00                    49I	#/* <<FUNCTION:  >>  REG_DTLB_LOAD                                                          
  00000000 00                       	                           */
  00000000 00                    50I	#/*                                                                                         
  00000000 00                       	                           */
  00000000 00                    51I	#/* <<DESCRIPTION:  >>  This function loads a PTE into a DTLB register by using the "tlbld" 
  00000000 00                       	instruction that loads the */
  00000000 00                    52I	#/*  data TLB entry from DCMP and RPA registers value. The register in parameter contains th
  00000000 00                       	e value of the effective a */
  00000000 00                    53I	#/* ddress of the TLB entry. It is a macro function in assembly language.                   
  00000000 00                       	                           */
  00000000 00                    54I	#/*                                                                                         
  00000000 00                       	                           */
  00000000 00                    55I	#/* END FUNCTION HEADER---------------------------------------------------------------------
  00000000 00                       	-------------------------- */
  00000000 00                    56I	REG_TLB_LOAD: .macro
                                 57I		sync
                                 58I		tlbwe
                                 59I		isync
                                 60I	
                                 61I		.endm
  00000000 00                    62I	#/*End of REG_DTLB_LOAD*/
  00000000 00                    63I	
  00000000 00                    64I	#/* _END_MACRO =============================================================================
  00000000 00                       	========================== */
  00000000 00                     3 	
  00000000 00                     4 		.global ELBCBOOT_CBHW_ConfigureBasicHW
  00000000 00                     5 	
  00000000 00                     6 	ELBCBOOT_CBHW_ConfigureBasicHW:
  00000000 00                     7 	
  00000000 00                     8 	;/* TLB */
  00000000 00  3c60 1000          9 		lis     r3,0x1000
  00000004 00  3c80 c000         10 		lis     r4,0xC000
  00000008 00  6084 0b00         11 		ori     r4,r4,0x0B00
  0000000c 00  38a0 000e         12 		li      r5,0x000E
  00000010 00  38c0 0015         13 		li      r6,0x0015
  00000014 00  38e0 0000         14 		li      r7,0x0000
  00000018 00                    15 	
  00000018 00                    16 	;/* Prepare MMU Assist registers */
  00000018 00  7c70 9ba6         17 		mtspr    REG_MAS0,   r3
  0000001c 00  7c91 9ba6         18 		mtspr    REG_MAS1,   r4
  00000020 00  7cb2 9ba6         19 		mtspr    REG_MAS2,   r5
  00000024 00  7cd3 9ba6         20 		mtspr    REG_MAS3,   r6
  00000028 00  7cf0 eba6         21 		mtspr    REG_MAS7,   r7
  0000002c 00                    22 	
  0000002c 00                    23 	;/* Write TLB entry */
  0000002c 00                    24 	   	REG_TLB_LOAD
  0000002c 00  7c00 04ac         57M		sync
                               File: ELBCBOOT_C Errors    0
  Location Pl  Code            Line 	Source Statement
  00000030 00  7c00 07a4         58M		tlbwe
  00000034 00  4c00 012c         59M		isync
  00000038 00                    60M	
  00000038 00                    25 		
  00000038 00                    26 	; Set HID0 default value
  00000038 00  3c60 0000         27 		lis     r3, C_HID0_INIT_VALUE@ha
  0000003c 00  3863 4000         28 		addi    r3, r3, C_HID0_INIT_VALUE@l
  00000040 00  7c70 fba6         29 		mtspr   REG_HID0, r3
  00000044 00                    30 		
  00000044 00  4e80 0020         31 		blr
